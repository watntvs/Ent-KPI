<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“˜ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ø§ÙˆÙ†Øª Ù…Ø§Ù„ÛŒ</title>
  <style>
    /* Ù‡Ù…Ø§Ù† Ø§Ø³ØªØ§ÛŒÙ„ Ù‚Ø¨Ù„ÛŒ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± */
  </style>
</head>
<body>
  <div class="background-overlay">
    <img src="entehkhab-logo.png" alt="Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©">
  </div>

  <div class="content">
    <h1>ğŸ“˜ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ø§ÙˆÙ†Øª Ù…Ø§Ù„ÛŒ</h1>
    <div id="dashboard"></div>

    <div id="indicatorModal" class="modal">
      <div class="modal-content">
        <span class="close-button" onclick="closeModal()">âœ–</span>
        <div id="indicatorContent"></div>
        <button id="backButton" onclick="closeModal()">ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª</button>
      </div>
    </div>
  </div>

  <script>
    let icons = {};

    fetch("icons.json")
      .then(res => res.json())
      .then(data => {
        icons = data;
        loadDomains();
      });

    function loadDomains() {
      // ÙÙ‚Ø· Ø¯Ø§Ù…Ù†Ù‡ 01 Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
      fetch("domain_01.json")
        .then(res => res.json())
        .then(domain => {
          const container = document.getElementById("dashboard");
          const details = document.createElement("details");
          const summary = document.createElement("summary");

          summary.innerHTML = `<span class="domain-icon">ğŸ“˜</span> Ø¯Ø§Ù…Ù†Ù‡ 01 â€“ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ù…Ø§Ù„ÛŒ`;
          details.appendChild(summary);

          domain.subgroups.forEach(sub => {
            const subgroupTitle = document.createElement("div");
            subgroupTitle.className = "subgroup-title";
            subgroupTitle.textContent = sub.title;
            subgroupTitle.style.color = sub.color || "#007f00";
            details.appendChild(subgroupTitle);

            sub.categories.forEach(cat => {
              const catItem = document.createElement("li");
              catItem.textContent = cat.title;

              const itemList = document.createElement("ul");
              cat.items.forEach(item => {
                const li = document.createElement("li");
                const a = document.createElement("a");
                a.href = "#";
                a.textContent = item.title;
                a.addEventListener("click", () => showIndicator(item.id));
                li.appendChild(a);
                itemList.appendChild(li);
              });

              const catWrapper = document.createElement("ul");
              catWrapper.appendChild(catItem);
              catWrapper.appendChild(itemList);
              details.appendChild(catWrapper);
            });
          });

          container.appendChild(details);
        });
    }

    function showIndicator(indicatorId) {
      fetch(`domain_01/${indicatorId}.json`)
        .then(res => res.json())
        .then(data => {
          const container = document.getElementById("indicatorContent");
          container.innerHTML = `
            <h2>ğŸ“Š ${data.title}</h2>
            <p><strong>ğŸ”¹ ØªØ¹Ø±ÛŒÙ:</strong> ${data.definition || "ØªÙˆØ¶ÛŒØ­ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª."}</p>
            <hr>
            <p><strong>ğŸ“ ÙØ±Ù…ÙˆÙ„ Ù…Ø­Ø§Ø³Ø¨Ù‡:</strong></p>
            <p class="formula-box">${data.formula || "Ù†Ø§Ù…Ø´Ø®Øµ"}</p>
            <hr>
            <p><strong>ğŸ“¦ Ø§Ø¬Ø²Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ:</strong></p>
            <ul>${(data.inputs || []).map(i => `<li>${i}</li>`).join("")}</ul>
            <hr>
            <p><strong>ğŸ“Š ÙˆØ§Ø­Ø¯ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ:</strong> ${data.unit || "Ù†Ø§Ù…Ø´Ø®Øµ"}</p>
            <hr>
            ${data.interpretation ? `
              <p><strong>ğŸ¯ ØªÙØ³ÛŒØ± Ø¹Ø¯Ø¯ Ø´Ø§Ø®Øµ:</strong></p>
              <table>
                <tr><th>Ù…Ù‚Ø¯Ø§Ø±</th><th>ØªÙØ³ÛŒØ±</th></tr>
                ${data.interpretation.map(row => `<tr><td>${row.range}</td><td>${row.meaning}</td></tr>`).join("")}
              </table>
              <hr>
            ` : ""}
            ${data.example ? `
              <p><strong>ğŸ“ˆ Ù…Ø«Ø§Ù„ Ø¹Ø¯Ø¯ÛŒ:</strong></p>
              <div class="example-box">
                ${Object.entries(data.example.values).map(([k,v]) => `â€¢ ${k} = ${v}<br>`).join("")}
                <br><br>${data.example.calculation}
              </div>
              <hr>
            ` : ""}
            <p><strong>ğŸ“‚ Ø±ÙˆØ´ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:</strong></p>
            <ul>${(data.source || []).map(s => `<li>${s}</li>`).join("")}</ul>
          `;
          document.getElementById("indicatorModal").style.display = "block";
        })
        .catch(error => {
          alert("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø§Ø®Øµ: " + indicatorId);
          console.error(error);
        });
    }

    function closeModal() {
      document.getElementById("indicatorModal").style.display = "none";
    }
  </script>
</body>
</html>
